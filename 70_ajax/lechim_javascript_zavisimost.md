## Лечим JavaScript зависимость {#javascript}

Любовь к AJAX бывает чрезмерной, и в погоне к Web2.0 (3.0, 4.0, … — желаемое подчерк-нуть) мы создаём сайты в которых все наши действия бегут через [XMLHTTPRequest](http://ru.wikipedia.org/wiki/XMLHttpRequest). Нет, это конечно не плохо — снижаем нагрузку на сервер, канал и т.д. и т.п., но есть одно «но» — у нас есть поисковые машины, которые не озадачивают себя выполнением JavaScript кода, а контент, спрятанный за AJAX запросом, им отдать всё таки нужно. Следовательно, у нас возникает необходимость дублирования навигации (это как минимум) для клиентов без JavaScript.

_Стоит помнить, что есть ещё пользователи, у которых отключён JavaScript в браузере (или даже не поддерживается, привет тебе, рысь), но эти знают, что делают. А есть ещё скрипты, которые ломаются, и не дают обычным пользователям воспользоваться навигацией по сайту, а пользователей это очень сильно расстраивает, так что эта глава не «просто так»._

Как же всё это обойти и на грабли не наступить? Да всё очень просто — создавайте обычную навигацию, которую вы бы делали не слышав ни разу о AJAX и компании:

&lt;ul class=&quot;navigation&quot;&gt;

&lt;li&gt;&lt;a href=&quot;/&quot;&gt;Home&lt;/a&gt;&lt;/li&gt;

&lt;li&gt;&lt;a href=&quot;/about.html&quot;&gt;About Us&lt;/a&gt;&lt;/li&gt;

&lt;li&gt;&lt;a href=&quot;/contact.html&quot;&gt;Contact Us&lt;/a&gt;&lt;/li&gt;

&lt;/ul&gt;

&lt;section id=&quot;content&quot;&gt;&lt;!-- Content --&gt;&lt;/section&gt;

Данный пример работает у нас без JavaScript’a, все страницы в нашем меню используют один и тот же шаблон для вывода информации, и по факту у нас изменяется лишь содержимое &lt;div&gt; с «id=&quot;content&quot;». Теперь приступим к загрузке контента посредством AJAX – для этого добавим следующий код:

$(function() {

// вешаем обработчик на все ссылки в нашем меню navigation

$(&quot;ul.navigation a&quot;).click(function(){

var url = $(this).attr(&quot;href&quot;); // возьмем ссылку

url =+ &quot;?ajax=true&quot;; // добавим к ней параметр ajax=true

$(&quot;#content&quot;).load(url); // загружаем обновлённое содержимое

return false; // возвращаем false

// - дабы не сработал переход по ссылке

});

});

В данном примере мы предполагаем, что сервер, видя параметр «ajax=true» вернет нам не полностью всю страницу, а лишь обновление для искомого элемента &lt;div id=&quot;content&quot;&gt;.

_Конечно, сервер должен быть умнее и не требовать явного указания для использования AJAX’а, а должен вполне удовлетвориться, словив header «X_REQUESTED_WITH» со значением «XMLHttpRequest». Большинство современных фреймворков для web-разработки с этим справляются «из коробки»._

Если же управлять поведением сервера проблематично, и он упёрто отправляет нам всю страницу целиком, то можно написать следующий код:

$(function() {

// вешаем обработчик на все ссылки в нашем меню navigation

$(&quot;ul.navigation a&quot;).click(function(){

var url = $(this).attr(&quot;href&quot;); // возьмем ссылку

// загружаем страницу целиком, но в наш контейнер вставляем

// лишь содержимое #content загружаемой страницы

$(&quot;#content&quot;).load(url + &quot; #content &gt; *&quot;);

return false; // возвращаем false

});

});

Если в подгружаемом содержимом так же есть ссылки – то вы уже должны знать как «оживить» события.
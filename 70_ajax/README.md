# 70% AJAX {#70}

Что такое AJAX, я, думаю, рассказывать не стоит, ибо с приходом веб-два-нуля большинство пользователей уже воротят носом от перезагрузок страниц целиком, а с появлением jQuery реализация упростилась в разы…

Начнём с самого простого – загрузка HTML-кода в необходимый нам DOM-элемент на странице. Для этой цели нам подойдет метод «.load()». Данный метод может принимать следующие параметры:

`url` – запрашиваемой страницы

`data` – передаваемые данные (необязательный параметр)

`callback` – функция, которая будет вызвана при завершении запроса к серверу (необязательный параметр)

Теперь на примерах:

```javascript
// в элемент с id="content" будет вставлен весь HTML с указанной страницы
$("#content").load("/get-my-page.html");

// в элемент с id="content" будет вставлен HTML с указанной страницы, выбранный по указанному селектору id="wrapper"
$("#content").load("/get-my-page.html #wrapper");

// передаём данные на сервер
$("#content").load("/get-my-page.html", {id:42});

// обрабатываем полученные данные
$("#content").load("/get-my-page.html", function(){
    alert("Ничего оригинальней не придумал");
});
```

> _Из моего опыта работы – вам очень часто придётся пользоваться методом «.load()» как описано в первом примере. А ещё советую запомнить второй пример, он может выручить, когда надо реализовать загрузку через AJAX, а доступа к сервер-сайду у вас нет или он ограничен._

> _Живой пример можно пощупать на страничке – [ajax.load.html](http://anton.shevchuk.name/book/code/ajax.load.html)._

Следующий метод, с которым я вас познакомлю будет «$.ajax()» – собственно, он тут главный, и все остальные AJAX-методы являются лишь обёрткой (и «.load()» в том же числе). Метод «$.ajax()» принимает в качестве параметра пачку настроек и URL цели. Приведу пример, аналогичный вызову «.load()»:

```javascript
$.ajax({
    url: "/get-my-page.html", // указываем URL
    method: "GET",            // HTTP метод, по умолчанию GET
    data: {"id": 42},         // данные, которые отправляем на сервер
    dataType: "html",         // тип данных загружаемых с сервера
    success: function (data) {
        // вешаем свой обработчик события success
        $("#content").html(data);
    }
});
```

> _Тут мы обрабатывали HTML-ответ от сервера – это хорошо когда нам полстраницы обновить надо, но данные лучше передавать в «правильном» формате. XML – это понятно, структурировано, но избыточно и как-то не совсем JavaScript-way, и поэтому наш выбор – это [JSON](http://ru.wikipedia.org/wiki/JSON):_

```json
{
  "note": {
    "time":"2012.09.21 13:11:15",
    "text":"Рассказать про JSONP"
  }
}
```

Фактически, это и есть JavaScript-код как есть (JavaScript Object Notation, если быть придирчиво точным). При этом формат уже распространён настолько, что работа с данными в другом формате уже не приветствуется.

> _Жизнь не стоит на месте, есть и более удобные форматы, но не в JavaScript :)_

Для загрузки JSON существует быстрая функция-синоним – «jQuery.getJSON()» – в качестве обязательного параметра лишь ссылка, куда стучимся, опционально можно указать данные для передачи на сервер и функцию обратного вызова.

> _Нельзя просто так взять и описать все возможные параметры для вызова «$.ajax()», таки стоит держать под рукой официальный мануал [http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)._

Ещё есть пара-тройка функций, которые стоит упомянуть:

`get(url, data, success, dataType)` — загружает данные методом GET

`post(url, data, success, dataType)` — загружает данные методом POST

`getScript(url, success)` — загружает JavaScript с сервера методом GET

Все они, как я уже говорил ранее, лишь обёртки над вызовом «$.ajax()», в чём несложно убедиться, заглянув в исходный код библиотеки. И там, на строчках с 9 137 по 9 156, вы найдёте реализацию методов «$.get()» и «$.post()» :)

Данная информация актуальна для jQuery версии 3.1.0.
